-- ğŸ† VentasConTopN â€” Ranking dinÃ¡mico con categorÃ­a "Otros"
--
-- Esta medida DAX permite mostrar los Top N elementos (ej. clientes, productos)
-- y agrupar el resto bajo una fila "Otros", sumando sus valores.
-- Muy Ãºtil en visuales tipo grÃ¡fico de barras o tablas donde el espacio es limitado
-- pero no se quiere perder informaciÃ³n.

VentasConTopN =
VAR TopNClientes = 
    TOPN(
        5,
        SUMMARIZE(DimCliente, DimCliente[Nombre], "Ventas", [Total Ventas]),
        [Ventas], DESC
    )
    -- ğŸŸ¢ Obtiene los 5 clientes con mayor total de ventas

VAR TodosClientes =
    ADDCOLUMNS(
        VALUES(DimCliente[Nombre]),
        "Ventas", [Total Ventas]
    )
    -- ğŸŸ¢ Lista todos los clientes con su total de ventas

VAR Otros = 
    SUMX(
        EXCEPT(TodosClientes, TopNClientes),
        [Ventas]
    )
    -- ğŸŸ¢ Calcula la suma de ventas de todos los clientes que no estÃ¡n en el Top N

RETURN
UNION(
    TopNClientes,
    ROW("Nombre", "Otros", "Ventas", Otros)
)
-- ğŸŸ¢ Une el Top N con una fila adicional llamada "Otros" que representa el resto

-- ğŸ“Š Ejemplo de salida (grÃ¡fico de barras o tabla):
-- Nombre        | Ventas
-- ------------- | --------
-- Cliente A     | 12000
-- Cliente B     | 9800
-- Cliente C     | 8700
-- Cliente D     | 8600
-- Cliente E     | 7900
-- Otros         | 22000

-- âœ… CuÃ¡ndo usar esta medida:
-- - Para evitar visuales saturadas con cientos de valores
-- - Para priorizar anÃ¡lisis de los elementos mÃ¡s relevantes
-- - Para resÃºmenes ejecutivos donde se desea foco en los principales y su impacto global

-- ğŸ’¡ Consejo:
-- Puedes hacer que el "Top N" sea dinÃ¡mico usando un parÃ¡metro o medida con SELECTEDVALUE().
